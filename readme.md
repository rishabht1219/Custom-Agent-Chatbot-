# Custom Agent Chatbot with FastAPI and RAG

This project implements a chatbot service using FastAPI and a custom-built agent leveraging the Yandex GPT model. The agent is designed to process queries via an API and integrates external tools, such as a custom "University_tool," to provide more sophisticated responses and general queries of users. Additionally, the chatbot employs **Retrieval-Augmented Generation (RAG)** to improve response accuracy by retrieving relevant information from documents.

## Features

- **FastAPI Backend**: Handles incoming HTTP requests and processes queries.
- **Custom Agent**: Built using the `langchain` framework and the Yandex GPT model (`ChatYandexGPT`).
- **Tool Integration**: The agent can utilize external tools such as "University_tool" to enhance its capabilities.
- **RAG (Retrieval-Augmented Generation)**: Improves response generation by retrieving relevant information from external documents.

## Getting Started

### Prerequisites

- Python 3.8 or higher
- Install required dependencies from `requirements.txt`

### Installation

1. Clone the repository:
    ```bash
    git clone https://github.com/your-repo/custom-agent-chatbot.git
    cd custom-agent-chatbot
    ```

2. Install the dependencies:
    ```bash
    pip install -r requirements.txt
    ```

3. Set up your Yandex API key and folder ID:
    ```bash
    export YC_API_KEY="Your Yandex GPT API Key"
    export YC_FOLDER_ID="Your Yandex FOLDER ID"
    ```

4. Make sure you have a text file with relevant information to be used by the **RAG** pipeline.

### Running the Application

1. Run the FastAPI server:
    ```bash
    uvicorn main:app --reload --host "localhost" --port "<your-port>"
    ```

2. You can now interact with the agent by sending POST requests to `/chat`.

Example request:

```bash
POST http://127.0.0.1:8001/chat
Content-Type: application/json

{
  "query": "Your query"
}
```
The server will return a response generated by the agent.

## API Endpoints

### POST `/chat`

- **Request Body**: JSON object containing the `query` string to be processed.
- **Response**: The agent's response based on the provided query.

Example response:

```bash
{
  "response": "Agent Response"
}
```
## Retrieval-Augmented Generation (RAG)

**Retrieval-Augmented Generation (RAG)** enhances the agent's ability to generate accurate, contextually relevant responses by retrieving information from external documents and integrating it with the generation process.

### How RAG Works:

1. **Document Loading**: Relevant documents are loaded from a predefined source (e.g., a text file).
   
2. **Document Splitting**: The documents are split into smaller chunks for efficient retrieval.

3. **Embedding Creation**: The Yandex GPT model creates embeddings for each chunk, which are stored in a FAISS vector store for fast retrieval.

4. **Query Retrieval**: When a user submits a query, the FAISS store is searched to find the most relevant document chunks.

5. **Response Generation**: The retrieved information is combined with the model's reasoning capabilities to generate a coherent and relevant response.

By using RAG, the chatbot provides more accurate and context-aware responses, especially when the query requires specific information.

## Custom Agent Details

The agent is built using the `langchain` framework and integrates tools via `ToolsController`. It leverages the `ChatYandexGPT` model to process queries and uses RAG to enhance the relevance and accuracy of its responses by retrieving contextually relevant data.


